import numpy as np
import pandas as pd
from scipy.interpolate import CubicSpline

'''
y1 = [[[[4.755125522613525, 470146.375]], [[5.088517665863037, 495625.78125]], [[3.241945266723633, 514719.65625]], [[3.3696534633636475, 459946.34375]], [[6.555746078491211, 459240.8125]], [[6.619713306427002, 461892.125]], [[10.701458930969238, 427819.25]], [[6.380965232849121, 462521.625]], [[4.53948450088501, 460515.4375]], [[7.3849568367004395, 432141.3125]]]]
g1 = [[[[1.6757181811044575e-06, 0.16642707586288452, -0.08057919889688492, -6275.6845703125]], [[3.2040300084190676e-06, 0.28685253858566284, 0.006312049925327301, -2830.603759765625]], [[0.00011231199459871277, 17.541357040405273, 0.027425546199083328, -5644.27294921875]], [[1.0366334208811168e-05, 1.5998904705047607, -0.005393259227275848, -1373.4375]], [[0.0003678715438582003, 42.667842864990234, 0.02855108119547367, -6002.09033203125]], [[0.0004719455901067704, 28.84522819519043, -0.03151409327983856, -3024.989501953125]], [[5.434676495497115e-06, 0.2185133546590805, -0.0036303363740444183, 910.928955078125]], [[0.0009480497683398426, 52.87995529174805, 0.0018764585256576538, -173.03369140625]], [[4.2911728087347e-05, 3.787043333053589, 0.029159553349018097, -15294.92578125]], [[6.48834020466893e-06, 0.4030454456806183, 0.023362450301647186, 4981.7197265625]]]]
y2 = [[[[4.504968643188477, 475630.125]], [[5.048949241638184, 492348.15625]], [[3.5286834239959717, 516818.53125]], [[3.495490789413452, 438058.28125]], [[6.7579345703125, 452517.3125]], [[7.032092094421387, 449481.34375]], [[10.320921897888184, 426963.5625]], [[6.301182270050049, 450098.5625]], [[3.7723946571350098, 462530.53125]], [[6.7183966636657715, 431828.53125]]]]
g2 = [[[[1.6500496258231578e-06, 0.09860505163669586, 0.007092309184372425, -188.121337890625]], [[4.163121047895402e-06, 0.2739883065223694, 0.014501599594950676, -1096.6171875]], [[0.00010035642480943352, 10.181550979614258, -0.04812624305486679, 7574.12109375]], [[6.859496352262795e-05, 5.712003231048584, 0.022149115800857544, -5323.7900390625]], [[0.0016318383859470487, -68.73580932617188, 0.0510064959526062, 17944.66015625]], [[0.0007356790010817349, -219.3813934326172, 1.7476983070373535, 40870.81640625]], [[5.283942755340831e-06, 0.371073454618454, -0.06631866097450256, -3810.21484375]], [[0.0028668362647295, 614.013916015625, -0.04265189170837402, -35527.85546875]], [[7.15100031811744e-05, -6.18843412399292, 0.002745462581515312, 14978.6611328125]], [[-3.1721860977995675e-06, 1.0313055515289307, -0.2694070637226105, -1489.5634765625]]]]
y3 = [[[[5.179712295532227, 460497.0625]], [[6.523539066314697, 478155.21875]], [[2.869802474975586, 523547.375]], [[4.3808722496032715, 452842.8125]], [[7.768556594848633, 456308.53125]], [[6.573707103729248, 460884.125]], [[8.81462287902832, 450753.34375]], [[6.983148097991943, 464336.25]], [[4.2568793296813965, 468146.4375]], [[6.749853134155273, 448897.5]]]]
g3 = [[[[4.299898137105629e-06, 0.14294032752513885, 0.004769220948219299, 1790.138671875]], [[-0.0043294369243085384, 0.36241939663887024, -71.5958251953125, -5408.46728515625]], [[-8.022808469831944e-05, 15.818490982055664, 0.0018256306648254395, -947.171142578125]], [[2.117770054610446e-05, 1.4495713710784912, 0.01700575277209282, -4288.580078125]], [[0.0011872119503095746, 52.42814636230469, 0.04537835717201233, -1524.04296875]], [[0.00018971048120874912, 29.486465454101562, 0.008487813174724579, -1064.03759765625]], [[2.622175770738977e-06, 0.25310030579566956, -0.06284016370773315, -3127.786376953125]], [[0.0012028578203171492, 58.861717224121094, 0.03082994371652603, -1541.80419921875]], [[0.00014857294445391744, 4.01667594909668, 0.5064210891723633, -7537.2001953125]], [[1.3767627933702897e-05, 0.341412752866745, 0.19773690402507782, -5539.90576171875]]]]
y4 = [[[[5.17297887802124, 454340.125]], [[6.604989528656006, 481944.84375]], [[2.4354121685028076, 518953.25]], [[3.5467336177825928, 461557.59375]], [[8.119423866271973, 455803.75]], [[6.525608539581299, 458273.96875]], [[8.307352066040039, 456456.9375]], [[6.25161075592041, 467687.90625]], [[4.395079612731934, 472447.21875]], [[6.289927005767822, 456789.6875]]]]
g4 = [[[[3.0073042580625042e-06, -0.6358448266983032, -0.018154442310333252, 45822.06640625]], [[7.673011168662924e-06, 0.28895875811576843, -1.4933335781097412, 11637.5302734375]], [[7.823579653631896e-05, 15.60589599609375, 0.007493771146982908, -1135.62548828125]], [[2.5200924937962554e-06, 1.5269761085510254, 0.02135327458381653, -1068.25048828125]], [[0.000890181923750788, 38.33290481567383, 0.01929892599582672, -2616.494140625]], [[0.0005781517247669399, 31.387184143066406, 0.02986888214945793, -6262.0830078125]], [[4.6751356421737e-06, 0.21534691751003265, 0.0190582312643528, -2101.525634765625]], [[0.00039468269096687436, 39.49000930786133, 0.015564940869808197, 335.85888671875]], [[5.033942579757422e-05, 3.2085351943969727, -0.13495373725891113, 2933.900390625]], [[1.8987549310622853e-06, 0.2631237804889679, -0.0070609599351882935, -1290.654541015625]]]]
y5 = [[[[5.392381191253662, 458262.375]], [[6.393589973449707, 474915.75]], [[3.051797866821289, 519824.875]], [[2.870959758758545, 464497.6875]], [[6.544832706451416, 458155.15625]], [[7.126661777496338, 461601.28125]], [[8.136141777038574, 451900.0]], [[6.897491931915283, 462110.0]], [[4.367529392242432, 468737.34375]], [[7.037961006164551, 449859.75]]]]
g5 = [[[[2.4519063117622864e-06, 0.06940247863531113, -0.03234317898750305, 8370.14453125]], [[1.444044119125465e-05, 0.20778422057628632, -0.39260926842689514, -11279.6552734375]], [[1.5264148487403872e-06, 15.439971923828125, 0.029025554656982422, -817.74267578125]], [[9.161718480754644e-06, 1.5391290187835693, 0.0026570758782327175, -3093.06884765625]], [[0.0005587872583419085, 40.06414794921875, 0.024496030062437057, -2820.99462890625]], [[0.002010627184063196, 24.493600845336914, -0.8037357330322266, 2528.5869140625]], [[4.103364517504815e-06, 0.21120399236679077, 0.025559384375810623, -4791.470703125]], [[0.0009603096987120807, 51.359107971191406, 0.024067532271146774, -1661.290771484375]], [[4.294231257517822e-05, 3.570066452026367, 0.014680147171020508, -1720.04541015625]], [[6.285217750701122e-06, 0.3167756199836731, 0.0017478764057159424, -1174.64501953125]]]]
y6 = [[[[4.691673755645752, 451599.5]], [[6.824574947357178, 467040.6875]], [[3.732199192047119, 506403.90625]], [[3.334012269973755, 443911.09375]], [[7.29674768447876, 440140.125]], [[7.060448169708252, 443998.375]], [[9.537460327148438, 423314.8125]], [[6.142205715179443, 443387.625]], [[4.355000019073486, 449489.125]], [[7.6341094970703125, 421982.46875]]]]
g6 = [[[[4.708344476966886e-06, 0.34978508949279785, -0.03569050133228302, 28831.3046875]], [[6.105812644818798e-06, 0.915984034538269, 0.01707799732685089, -5185.15625]], [[0.00010157439101021737, 18.188596725463867, -0.012310120277106762, -8438.5234375]], [[2.2200716557563283e-05, 5.894379615783691, 0.04553450271487236, -15354.4267578125]], [[0.0064876205287873745, 75.98236846923828, -0.03804051876068115, 1079.79248046875]], [[-0.012331617996096611, 71.96747589111328, 1.9368112087249756, -7750.8759765625]], [[1.7782538179744733e-06, 0.386788934469223, 0.020510435104370117, 1565.864013671875]], [[0.0009617450996302068, 75.44371795654297, 0.032504282891750336, -1049.684814453125]], [[4.7683923185104504e-05, 5.041786193847656, 0.026079807430505753, 159.625]], [[3.3152452942886157e-06, 0.2361922562122345, 0.0016536414623260498, 1899.50830078125]]]]
y7 = [[[[4.682933330535889, 451972.875]], [[6.712252140045166, 476116.34375]], [[3.0436599254608154, 510309.0625]], [[2.6848886013031006, 456063.0]], [[7.591050148010254, 451223.9375]], [[7.017524719238281, 455400.21875]], [[9.441221237182617, 430955.21875]], [[6.542837142944336, 452060.46875]], [[3.6139533519744873, 458149.375]], [[7.4812397956848145, 429565.84375]]]]
g7 = [[[[7.719541827100329e-06, 3.551703453063965, -0.004059940576553345, -45503.80078125]], [[1.035941022564657e-05, -0.2417469322681427, -0.32419657707214355, 16475.95703125]], [[-0.0004924110835418105, -125.49018096923828, -0.091225765645504, 43217.50390625]], [[3.7943059396639e-06, 0.3042617738246918, 0.004624268505722284, -3802.036865234375]], [[0.0008612906676717103, -59.67668533325195, -0.14910364151000977, 13864.4248046875]], [[0.0010581652168184519, 10.330260276794434, 1.236365795135498, 12247.29296875]], [[-1.1771378922276199e-05, 0.6581453084945679, -0.023771613836288452, -5462.70703125]], [[0.018098393455147743, 3053.6318359375, -0.8112750053405762, -121148.1796875]], [[4.984209226677194e-05, -2175.597412109375, 0.011612758971750736, 2311876.25]], [[4.950228230882203e-06, 0.5094510912895203, -0.0405367948114872, -6742.384765625]]]]

array_y1 = np.array(y1)
y1 = np.squeeze(array_y1)
array_y2 = np.array(y2)
y2 = np.squeeze(array_y2)
array_y3 = np.array(y3)
y3 = np.squeeze(array_y3)
array_y4 = np.array(y4)
y4 = np.squeeze(array_y4)
array_y5 = np.array(y5)
y5 = np.squeeze(array_y5)
array_y6 = np.array(y6)
y6 = np.squeeze(array_y6)
array_y7 = np.array(y7)
y7 = np.squeeze(array_y7)
merged_array_y = np.concatenate((y1, y2, y3, y4, y5, y6, y7), axis=0)

array_g1 = np.array(g1)
g1 = np.squeeze(array_g1)
array_g2 = np.array(g2)
g2 = np.squeeze(array_g2)
array_g3 = np.array(g3)
g3 = np.squeeze(array_g3)
array_g4 = np.array(g4)
g4 = np.squeeze(array_g4)
array_g5 = np.array(g5)
g5 = np.squeeze(array_g5)
array_g6 = np.array(g6)
g6 = np.squeeze(array_g6)
array_g7 = np.array(g7)
g7 = np.squeeze(array_g7)
merged_array_g = np.concatenate((g1, g2, g3, g4, g5, g6, g7), axis=0)

df1 = pd.DataFrame(merged_array_y, columns=['g', 'p'])
df2 = pd.DataFrame(merged_array_g, columns=['dgdx', 'dgdt', 'dpdx', 'dpdt'])

# 创建Excel写入对象
with pd.ExcelWriter('pde画图.xlsx', engine='xlsxwriter') as writer:
    # 写入DataFrame到Excel
    df1.to_excel(writer, sheet_name='Sheet1', index=False)
    df2.to_excel(writer, sheet_name='Sheet2', index=False)
'''
'''
d = [0.6, 0.35, 0.25, 0.3, 0.6, 0.35, 0.6, 0.6, 0.6, 0.25, 0.45, 0.35, 0.45, 0.35, 0.6, 0.45, 0.4, 0.45, 0.35, 0.45, 0.3, 0.45, 0.35]
np_d = np.array(d)
ind = [2, 3, 5, 9, 11, 13, 16, 18, 20, 22]
d = np_d[ind]
A = 3.14 * d ** 2 / 4
print(A)
k1 = -A[0]/(0.4615*549.9658495560284)
print(k1)
x1 = np.linspace(4, 6, 1000)
y1 = k1*x1

x2 = np.linspace(0, 1, 100)
y2 = np.linspace(0, 1, 100)
#z =
'''

# 读取Excel文件
excel_file = 'REAL_G10.xlsx'  # 用你的文件路径替换
df = pd.read_excel(excel_file)

# 样条插值函数
def cubic_spline_interpolation(series):
    x = np.arange(len(series))
    cs = CubicSpline(x, series, bc_type='natural')
    new_x = np.linspace(0, len(series) - 1, num=len(series) + 5 * (len(series) - 1))
    new_y = cs(new_x)
    return new_y

# 插值后的数据框
interpolated_df = pd.DataFrame()

# 对每一列的每两行之间进行样条插值
for col in df.columns:
    interpolated_col = cubic_spline_interpolation(df[col])
    interpolated_df[col] = interpolated_col

# 将插值结果保存到新的Excel文件
new_excel_file = 'interpolated_G.xlsx'
interpolated_df.to_excel(new_excel_file, index=False)

